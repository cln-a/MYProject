<UserControl x:Class="Application.Device.ModbusDeviceView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:controls="https://handyorg.github.io/handycontrol"
             xmlns:viewmodel="clr-namespace:Application.Device"
             prism:ViewModelLocator.AutoWireViewModel="True"
             mc:Ignorable="d" 
             d:DesignHeight="450" 
             d:DesignWidth="800"
             d:DataContext="{d:DesignInstance viewmodel:ModbusDeviceViewModel}"
             FontFamily="Microsoft YaHei"
             TextElement.FontSize="16"
             TextElement.FontWeight="Regular"
             TextElement.Foreground="{DynamicResource MaterialDesignBody}">
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:InvokeCommandAction Command="{Binding RefreshCommand}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Orientation="Horizontal">
        </StackPanel>
        <DataGrid 
            x:Name="ModbusDeviceDataGrid"
            Grid.Row="1"
            Margin="0,5,0,10"
            controls:DataGridAttach.CanUnselectAllWithBlankArea="True"
            AutoGenerateColumns="False"
            CanUserAddRows="False"
            HeadersVisibility="All"
            IsReadOnly="True"
            ItemsSource="{Binding Items}"
            MinRowHeight="45"
            RowHeaderWidth="60"
            SelectionMode="Single"
            SelectionUnit="FullRow">
            <DataGrid.Resources>
                <Style TargetType="DataGridCell">
                    <Setter Property="VerticalAlignment" Value="Center" />
                    <Setter Property="HorizontalAlignment" Value="Center" />
                    <Setter Property="BorderThickness" Value="0" />
                </Style>
            </DataGrid.Resources>
            <DataGrid.RowHeaderTemplate>
                <DataTemplate>
                    <CheckBox Margin="20,0,0,0" IsChecked="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=DataGridRow}}" />
                </DataTemplate>
            </DataGrid.RowHeaderTemplate>
            <DataGrid.Columns>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="Id" 
                    Header="序号" 
                    Binding="{Binding Id}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="DeviceUri" 
                    Header="设备标识符" 
                    Binding="{Binding DeviceUri}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="DeviceName" 
                    Header="设备名称" 
                    Binding="{Binding DeviceName}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="RemoteIpAddress" 
                    Header="远程地址" 
                    Binding="{Binding RemoteIpAddress}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="RemotePort" 
                    Header="远程端口" 
                    Binding="{Binding RemotePort}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="LocalIpAddress" 
                    Header="本机地址" 
                    Binding="{Binding LocalIpAddress}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="LocalPort" 
                    Header="本地端口" 
                    Binding="{Binding LocalPort}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="ReconnectInterval" 
                    Header="重连周期" 
                    Binding="{Binding ReconnectInterval}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="ReadInterval" 
                    Header="读取周期" 
                    Binding="{Binding ReadInterval}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="DeviceBrand" 
                    Header="设备品牌" 
                    Binding="{Binding DeviceBrand}"/>
                <DataGridCheckBoxColumn 
                    CanUserSort="True" 
                    SortMemberPath="IsEnabled" 
                    Header="可用" 
                    Binding="{Binding IsEnabled}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="Description" 
                    Header="描述" 
                    Binding="{Binding Description}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="Creator" 
                    Header="创建者" 
                    Binding="{Binding Creator}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="CreateTime" 
                    Header="创建时间" 
                    Binding="{Binding CreateTime}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="Updator" 
                    Header="修改者" 
                    Binding="{Binding Updater}"/>
                <DataGridTextColumn 
                    Width="Auto" 
                    CanUserSort="True" 
                    SortMemberPath="UpdateTime" 
                    Header="修改时间" 
                    Binding="{Binding UpdateTime}"/>
            </DataGrid.Columns>
        </DataGrid>
        <StackPanel
            Grid.Row="2"
            Margin="0,5,0,5"
            HorizontalAlignment="Center"
            Orientation="Horizontal">
            <materialDesign:PackIcon
                Width="24"
                Height="24"
                Cursor="Hand"
                Kind="ChevronLeft"/>
            <TextBlock
                Margin="10,0"
                VerticalAlignment="Center"
                Text="{Binding pageNumber, StringFormat='第{0}页'}" />
            <materialDesign:PackIcon
                Width="24"
                Height="24"
                Cursor="Hand"
                Kind="ChevronRight"/>
            <TextBlock
                Margin="0,0,10,0"
                VerticalAlignment="Center"
                Text="{Binding totalPage, StringFormat='共{0}页'}" />
        </StackPanel>
    </Grid>
</UserControl>
